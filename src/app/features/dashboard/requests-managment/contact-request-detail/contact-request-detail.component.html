<div class="bg-white d-flex flex-column justify-content-center py-3 mx-5 header border custom-rounded">
  <div class="d-flex align-items-center ps-3">
    <span class="material-symbols-outlined mr-2 px-3 fs-1" routerLink="/dashboard/requests-managment/contact-requests"
      style="cursor: pointer; color: #666666;">
      arrow_back
    </span>
    <h2 class="mb-0" style="color: #666666;">Solicitud No. {{request?.id}}</h2>
  </div>
</div>

<div class="m-5 content">
  <div class="bg-white px-5 py-4 rounded-5 border">
      <div class="mb-5">
      <h4>Información de la solicitud</h4>
    </div>
    <section *ngIf="request">
      <form>
        <div class="row mb-3">
          <div class="col">
            <label for="interestedPersonName">Nombre del interesado</label>
            <input type="text" id="interestedPersonName" class="form-control" [value]="request.missingPersonName">
          </div>

          <div class="col">
            <label for="missingPersonName">Nombre de la persona desaparecida</label>
            <input type="text" id="missingPersonName" class="form-control" [value]="request.missingPersonName" disabled>
          </div>
        </div>

        <div class="row mb-3">
          <div class="col">
            <label for="relationship">Relación</label>
            <input type="text" id="relationship" class="form-control" [value]="request.relationship" disabled>
          </div>

          <div class="col">
            <label for="phoneNumber">Número de teléfono</label>
            <input type="text" id="phoneNumber" class="form-control" [value]="request.phoneNumber" disabled>
          </div>
        </div>

        <div class="row mb-3">
          <div class="col">
            <label for="email">Correo electrónico</label>
            <input type="email" id="email" class="form-control" [value]="request.email" disabled>
          </div>

          <div class="col">
            <label for="requestDateTime">Fecha y hora de la solicitud</label>
            <input type="text" id="requestDateTime" class="form-control"
              [value]="formatDateTime(request.requestDateTime)" disabled>
          </div>
        </div>

        <div class="row mb-3">
          <div class="col">
            <label for="status">Estado</label>
            <select id="status" class="form-select fw-bold" [(ngModel)]="request.status" name="status"
              [ngClass]="getStatusClass(request.status)" (change)="onStatusChange()">
              <option *ngFor="let option of statusOptions" [value]="option.value"
                [ngClass]="getStatusClass(option.value)">
                {{option.label}}
              </option>
            </select>
          </div>

          <div class="col">
            <label for="attendingUser">Usuario atendiendo</label>
            <input type="text" id="attendingUser" class="form-control" [value]="request.attendingUser || 'No asignado'"
              disabled>
          </div>
        </div>
        <div class="mb-3">
          <label for="message">Mensaje</label>
          <textarea id="message" class="form-control" rows="3" readonly>{{request.message}}</textarea>
        </div>

        <p class="text-muted mt-3">Por favor, recuerda actualizar el estado de la solicitud una vez haya sido atendida.
        </p>
        <div *ngIf="updateMessage" class="alert mt-3"
          [ngClass]="{'alert-success': updateMessage.includes('éxito'), 'alert-danger': updateMessage.includes('Error')}">
          {{ updateMessage }}
        </div>

        <div class="d-flex justify-content-end align-items-center mt-4">
          <div *ngIf="statusChanged" class="alert alert-warning mb-0 flex-grow-1 me-3">
            Se han realizado cambios. No olvide actualizar.
          </div>
          <button type="button" class="btn btn-primary" (click)="updateStatus()"
            [disabled]="!statusChanged">Actualizar</button>
        </div>

      </form>
    </section>